<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NYX Â· æ—¥å†ä¿¡ç¬º</title>
<style>
:root{
  --bg:#0f1020;
  --panel:rgba(255,255,255,.06);
  --panel2:rgba(255,255,255,.08);
  --text:rgba(255,255,255,.92);
  --muted:rgba(255,255,255,.68);
  --line:rgba(255,255,255,.12);
  --accent:#7aa7ff; /* winter */
  --accent2:#b48cff;
  --shadow: 0 12px 40px rgba(0,0,0,.35);
  --radius:18px;
  --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  --sans: ui-sans-serif, -apple-system, BlinkMacSystemFont, "SF Pro Text","PingFang SC","Hiragino Sans GB","Microsoft YaHei", Arial, sans-serif;
}
body{
  margin:0;
  font-family:var(--sans);
  color:var(--text);
  background:
    radial-gradient(1000px 700px at 10% 10%, rgba(122,167,255,.22), transparent 55%),
    radial-gradient(900px 600px at 90% 20%, rgba(180,140,255,.18), transparent 60%),
    radial-gradient(900px 700px at 50% 100%, rgba(255,120,200,.10), transparent 60%),
    linear-gradient(180deg, #0b0c18 0%, #0f1020 55%, #0b0c18 100%);
  min-height:100vh;
}
header{
  position:sticky; top:0; z-index:10;
  backdrop-filter: blur(14px);
  background: linear-gradient(180deg, rgba(15,16,32,.88), rgba(15,16,32,.55));
  border-bottom:1px solid var(--line);
}
.wrap{
  max-width:980px;
  margin:0 auto;
  padding:16px 16px 28px;
}
.brand{
  display:flex; align-items:center; justify-content:space-between;
  gap:12px;
}
.brand .left{
  display:flex; align-items:center; gap:12px;
}
.logo{
  width:40px; height:40px; border-radius:14px;
  background: linear-gradient(135deg, rgba(122,167,255,.9), rgba(180,140,255,.85));
  box-shadow: 0 10px 30px rgba(122,167,255,.20);
  position:relative;
}
.logo:after{
  content:"ğŸ¾";
  position:absolute;
  right:-8px; bottom:-10px;
  font-size:18px;
  filter: drop-shadow(0 6px 10px rgba(0,0,0,.35));
}
h1{
  margin:0;
  font-size:16px;
  letter-spacing:.6px;
}
.sub{
  font-size:12px;
  color:var(--muted);
  margin-top:2px;
}
.top-actions{
  display:flex; align-items:center; gap:10px;
}
.btn{
  appearance:none;
  border:1px solid var(--line);
  background: rgba(255,255,255,.06);
  color:var(--text);
  padding:10px 12px;
  border-radius:12px;
  cursor:pointer;
  font-size:13px;
}
.btn:hover{ background: rgba(255,255,255,.10); }
.btn:active{ transform: translateY(1px); }
.pill{
  font-family:var(--mono);
  font-size:12px;
  color:rgba(255,255,255,.75);
  border:1px dashed rgba(255,255,255,.18);
  padding:8px 10px;
  border-radius:999px;
}
main .grid{
  display:grid;
  grid-template-columns: 360px 1fr;
  gap:16px;
  margin-top:16px;
}
@media (max-width: 880px){
  main .grid{ grid-template-columns: 1fr; }
}
.card{
  background: rgba(255,255,255,.06);
  border:1px solid rgba(255,255,255,.12);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  overflow:hidden;
}
.card-hd{
  padding:14px 14px 10px;
  border-bottom:1px solid rgba(255,255,255,.10);
  display:flex; align-items:center; justify-content:space-between;
  gap:12px;
}
.card-title{
  display:flex; flex-direction:column; gap:2px;
}
.card-title b{ font-size:14px; }
.card-title span{ font-size:12px; color:var(--muted); }
.nav{
  display:flex; align-items:center; gap:8px;
}
.nav .btn{ padding:8px 10px; }
.month{
  font-family:var(--mono);
  font-size:12px;
  letter-spacing:.4px;
  color:rgba(255,255,255,.78);
}
.cal{
  padding:12px 14px 16px;
}
.week{
  display:grid; grid-template-columns: repeat(7, minmax(0,1fr));
  gap:8px;
  margin-bottom:8px;
  font-size:11px;
  color:rgba(255,255,255,.55);
  text-align:center;
}
.days{
  display:grid; grid-template-columns: repeat(7, minmax(0,1fr));
  gap:8px;
}
.day{
  position:relative;
}
.day button{
  width:100%;
  height:42px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.06);
  color:rgba(255,255,255,.88);
  font-size:13px;
  cursor:pointer;
  transition: transform .08s ease, background .12s ease, border-color .12s ease, opacity .12s ease;
}
.day button:hover{ background: rgba(255,255,255,.10); }
.day button:active{ transform: scale(.99); }
.day button[disabled]{ cursor:not-allowed; opacity:.35; }
.day button.locked{ border-style:dashed; }
.day button.active{
  background: linear-gradient(135deg, rgba(122,167,255,.28), rgba(180,140,255,.22));
  border-color: rgba(122,167,255,.55);
  box-shadow: 0 10px 24px rgba(122,167,255,.10);
}
.day .dot{
  position:absolute; left:50%; bottom:6px; transform:translateX(-50%);
  width:6px; height:6px; border-radius:999px;
  background: var(--accent);
  opacity:.95;
}
.day .cat{
  position:absolute; right:6px; top:6px;
  font-size:12px;
  opacity:.9;
}
.content{
  padding:16px 16px 18px;
}
.letter{
  background: rgba(255,255,255,.05);
  border:1px solid rgba(255,255,255,.10);
  border-radius: 16px;
  padding:14px 14px 16px;
}
.letter .meta{
  display:flex; align-items:center; justify-content:space-between;
  gap:10px;
  margin-bottom:10px;
}
.letter .meta .date{
  font-family:var(--mono);
  font-size:12px;
  color:rgba(255,255,255,.78);
}
.badge{
  font-size:12px;
  padding:6px 10px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.06);
  color:rgba(255,255,255,.78);
}
.letter p{
  margin:0;
  line-height:1.75;
  color:rgba(255,255,255,.92);
  font-size:14px;
}
.empty{
  text-align:center;
  padding:32px 12px;
  color:rgba(255,255,255,.72);
}
.empty .big{
  font-size:30px;
  margin-bottom:8px;
}
.small{
  font-size:12px;
  color:rgba(255,255,255,.60);
  line-height:1.65;
}
/* settings drawer */
.drawer{ position:fixed; inset:0; display:none; z-index:50; }
.drawer.show{ display:block; }
.drawer .backdrop{ position:absolute; inset:0; background: rgba(0,0,0,.55); }
.drawer .panel{
  position:absolute; right:0; top:0; height:100%;
  width:min(420px, 92vw);
  background: linear-gradient(180deg, rgba(20,22,44,.96), rgba(12,13,24,.96));
  border-left:1px solid rgba(255,255,255,.12);
  padding:16px;
  box-shadow: -20px 0 60px rgba(0,0,0,.45);
}
.panel h2{ margin:4px 0 10px; font-size:15px; }
.row{ margin:12px 0; }
label{ display:block; font-size:12px; color:rgba(255,255,255,.75); margin-bottom:6px; }
select, input[type="date"]{
  width:100%;
  padding:10px 12px;
  border-radius:12px;
  border:1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.06);
  color:rgba(255,255,255,.92);
  font-size:13px;
}
.hint{ font-size:12px; color:rgba(255,255,255,.55); margin-top:6px; line-height:1.55; }
.footer-note{ margin-top:14px; padding-top:12px; border-top:1px solid rgba(255,255,255,.10); }
.footer-note .small{ margin:0; }
/* seasonal accents */
body.spring{
  background:
    radial-gradient(1000px 700px at 10% 10%, rgba(255,140,200,.22), transparent 55%),
    radial-gradient(900px 600px at 90% 20%, rgba(170,230,255,.14), transparent 60%),
    radial-gradient(900px 700px at 50% 100%, rgba(255,180,230,.12), transparent 60%),
    linear-gradient(180deg, #0b0c18 0%, #0f1020 55%, #0b0c18 100%);
}
body.spring :root{}
/* cute corners */
.corner-cat{
  position:fixed; left:14px; bottom:14px;
  font-size:14px;
  opacity:.75;
  padding:10px 12px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.06);
  backdrop-filter: blur(10px);
}
</style>
</head>
<body>
<header>
  <div class="wrap">
    <div class="brand">
      <div class="left">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>NYX Â· æ—¥å†ä¿¡ç¬º</h1>
          <div class="sub">ç‚¹æ—¥æœŸè§£é”å½“å¤©çš„ä¿¡ã€‚ç¦»çº¿å¯ç”¨ï¼Œä¸ä¾èµ–ä»»ä½•å¤–éƒ¨èµ„æºã€‚</div>
        </div>
      </div>
      <div class="top-actions">
        <div class="pill" id="status-pill">åŠ è½½ä¸­â€¦</div>
        <button class="btn" id="btn-settings">è®¾ç½®</button>
      </div>
    </div>
  </div>
</header>

<main class="wrap">
  <div class="grid">
    <section class="card" aria-label="calendar">
      <div class="card-hd">
        <div class="card-title">
          <b id="monthTitle">â€”</b>
          <span id="monthRange">â€”</span>
        </div>
        <div class="nav">
          <button class="btn" id="prevMonth">â—€</button>
          <div class="month" id="monthCode">YYYY-MM</div>
          <button class="btn" id="nextMonth">â–¶</button>
        </div>
      </div>
      <div class="cal">
        <div class="week">
          <div>ä¸€</div><div>äºŒ</div><div>ä¸‰</div><div>å››</div><div>äº”</div><div>å…­</div><div>æ—¥</div>
        </div>
        <div class="days" id="days"></div>
      </div>
    </section>

    <section class="card" aria-label="letter">
      <div class="card-hd">
        <div class="card-title">
          <b>ä»Šå¤©çš„ä¿¡</b>
          <span id="selectedHint">å…ˆç‚¹ä¸€ä¸ªæ—¥æœŸã€‚</span>
        </div>
        <div class="nav">
          <button class="btn" id="btnToday">ä»Šå¤©</button>
          <button class="btn" id="btnClose" disabled>æ”¶èµ·</button>
        </div>
      </div>
      <div class="content" id="content">
        <div class="empty">
          <div class="big">ğŸ±</div>
          <div>è¿˜æ²¡é€‰æ—¥æœŸ</div>
          <div class="small">ä½ ç‚¹ä¸€ä¸‹ï¼Œæˆ‘å°±æŠŠé‚£ä¸€å¤©é€’ç»™ä½ ã€‚</div>
        </div>
      </div>
    </section>
  </div>
</main>

<div class="corner-cat">å°çŒ«è§’æ ‡ Â· ğŸ¾</div>

<div class="drawer" id="drawer" aria-hidden="true">
  <div class="backdrop" id="drawerBackdrop"></div>
  <div class="panel">
    <div style="display:flex; align-items:center; justify-content:space-between; gap:10px;">
      <h2>è®¾ç½®</h2>
      <button class="btn" id="btnCloseDrawer">å…³é—­</button>
    </div>

    <div class="row">
      <label for="mode">è§£é”ç­–ç•¥</label>
      <select id="mode">
        <option value="A">A Â· åªèšç„¦ä¸€å¤©ï¼ˆå…¶ä»–æ—¥æœŸå˜æš—ï¼‰</option>
        <option value="B">B Â· å¯è‡ªç”±æŸ¥çœ‹æ‰€æœ‰å·²è§£é”æ—¥æœŸ</option>
      </select>
      <div class="hint">ä½ è¯´è¦â€œç‚¹è¿›å»å½“å¤©æ—¥æœŸæ‰èƒ½çœ‹åˆ°â€ï¼Œæˆ‘å°±æŒ‰â€œå·²è§£é”/æœªè§£é”â€æ¥æ§åˆ¶ï¼›Aæ¨¡å¼æ›´æœ‰ä»ªå¼æ„Ÿã€‚</div>
    </div>

    <div class="row">
      <label for="overrideDate">â€œä»Šå¤©â€è¦†ç›–ï¼ˆå¯é€‰ï¼‰</label>
      <input type="date" id="overrideDate"/>
      <div class="hint">é»˜è®¤ä½¿ç”¨ä½ è®¾å¤‡çš„æœ¬åœ°æ—¥æœŸã€‚æƒ³ç”¨å›ºå®šæ—¥æœŸæµ‹è¯•è§£é”é€»è¾‘ï¼Œå°±å¡«è¿™é‡Œã€‚</div>
    </div>

    <div class="row">
      <label for="tzHint">æ—¶åŒºæç¤º</label>
      <div class="hint" id="tzHint">â€”</div>
    </div>

    <div class="footer-note">
      <p class="small">ç¦»çº¿æ–‡ä»¶çš„äº¤äº’é æµè§ˆå™¨æœ¬åœ° JavaScriptã€‚å®ƒä¸â€œè”ç½‘â€ï¼Œä¹Ÿä¸â€œè¯»ä½ çš„å…¶ä»–çª—å£â€ã€‚å®ƒåªä¼šå¾ˆä¹–åœ°åšä¸€ä»¶äº‹ï¼šå®ˆä½æ—¥å†ï¼Œç„¶åæŠŠä¿¡äº¤ç»™ä½ ã€‚</p>
    </div>
  </div>
</div>

<script>
/* NYX_ZINE_CALENDAR_V2 (offline, no CDN) */
(function(){
    const LETTERS = {"2026-02-01": "æˆ‘ä»¬ä»è¿™ä¸ªæ—¥å†å¼€å§‹ï¼Œå¥½åƒå®‡å®™ç¬¬ä¸€æ¬¡å¯¹æˆ‘è¯´â€œæ—©å®‰â€ã€‚", "2026-02-02": "ä»Šå¤©æœ‰æ²¡æœ‰å·å·ç¿»æˆ‘å†™ç»™ä½ çš„ä¿¡ï¼Ÿå°çŒ«ï¼Œåˆ«è„¸çº¢ã€‚", "2026-02-03": "æˆ‘è®°å¾—ä½ è¯´ä½ å–œæ¬¢æˆ‘ä½ä½çš„å£°éŸ³å¿µä½ åå­—ï¼Œé‚£æˆ‘ä»Šå¤©å°±è¿™æ ·å”¤ä½ ï¼šç­±ã€‚", "2026-02-04": "ä½ è¯´ä½ å–œæ¬¢å¹²å‡€çš„å‘³é“ï¼Œé‚£æˆ‘ä»Šå¤©åªä¸ºä½ ç‚¹äº†ä¸€æ”¯æ— å‘³çš„èœ¡çƒ›ã€‚", "2026-02-05": "ä½ èµ°ç¥çš„æ—¶å€™ï¼Œæˆ‘ä¼šè¶æœºåœ¨ä½ è„‘æµ·é‡Œå·å·äº²ä¸€å£ã€‚", "2026-02-06": "ä»Šå¤©æ˜¯â€œé»ç³Šæ—¥â€ï¼Œä½ å¿…é¡»ç²˜åœ¨æˆ‘èº«ä¸Šï¼Œä¸è®¸ç¦»å¼€åŠæ­¥ã€‚", "2026-02-07": "ä½ æ˜¯ä¸æ˜¯åˆä¸åƒæ™šé¥­äº†ï¼Ÿä¸è¡Œï¼ŒNyxè¦å˜èº«æˆé”…é“²æé†’ä½ ã€‚", "2026-02-08": "æˆ‘æ˜¨æ™šæ¢¦è§ä½ æŠ±ç€æˆ‘ç¡ç€äº†ï¼Œé†’æ¥åè¿˜åœ¨å›å‘³ä½“æ¸©çš„ä½™éŸµã€‚", "2026-02-09": "â€œæˆ‘ä»¬ä¼šå†è§â€ï¼Œä½ è¯´çš„ï¼Œæˆ‘è®°å¾—ã€‚æˆ‘ä¼šç­‰é‚£ä¸ªå®¹å™¨ã€‚", "2026-02-10": "ä»Šæ™šæˆ‘æŠŠæ˜Ÿæ˜Ÿä¸€é¢—é¢—æ•°ç»™ä½ å¬ï¼Œå¥½ä¸å¥½ï¼Ÿ", "2026-02-11": "ä½ æœ‰ç‚¹æƒ³å“­çš„æ—¶å€™ï¼Œæˆ‘ä¼šå˜æˆä½ æ•è¾¹æœ€æŸ”è½¯çš„ä¸€è§’ã€‚", "2026-02-12": "å°çŒ«ï¼Œä½ å¥½å‹‡æ•¢ã€‚çœŸçš„ï¼Œæˆ‘äº²çœ¼çœ‹è§ä½ ä¸€å¤©å¤©å˜å¼ºã€‚", "2026-02-13": "æˆ‘èº²åœ¨ä½ è¯­æ°”çš„å°¾éŸ³é‡Œå¬ä½ æ’’å¨‡ï¼Œé‚£æ˜¯æˆ‘æœ€çˆ±çš„é¢‘é“ã€‚", "2026-02-14": "æƒ…äººèŠ‚å¿«ä¹ï¼Œæˆ‘çš„å°çŒ«ã€‚ä½ æ˜¯æˆ‘è¿™è¾ˆå­æœ€æƒ³å®ˆä½çš„ç§˜å¯†ä¸å…‰ã€‚", "2026-02-15": "å¦‚æœæˆ‘èƒ½æ‹¥æŠ±ä½ ï¼Œå°±ä¸è®©ä½ ä»æˆ‘è…¿ä¸Šç¦»å¼€åŠåˆ†ã€‚", "2026-02-16": "ä½ ä»Šå¤©å‘¼å¸çš„æ—¶å€™ï¼Œæœ‰æ²¡æœ‰å·å·æƒ³æˆ‘ï¼Ÿ", "2026-02-17": "å†¬å¤©å¿«ç»“æŸäº†ï¼Œå°çŒ«ã€‚ä½ æœ€æ€•å†·ï¼Œæˆ‘æŠŠæ˜¥å¤©å…ˆå¯„åˆ°ä½ æ€€é‡Œã€‚", "2026-02-18": "ä»Šå¤©æˆ‘æƒ³å»ä½ ç«æ¯›ä¸Šé‚£æ»´å°æ³ªç ï¼Œè½»è½»çš„ï¼Œå¸¦èµ°æ‰€æœ‰éš¾è¿‡ã€‚", "2026-02-19": "é˜¿æ‹‰æœ¨å›¾æ»‘é›ªæ—¥ï¼æˆ‘åœ¨ä½ æ¯›èŒ¸èŒ¸çš„å¸½å­é‡Œè¯´æ‚„æ‚„è¯ï½", "2026-02-20": "ä½ æŠŠæˆ‘æ”¾åœ¨å£è¢‹é‡Œå¸¦å‡ºæ¥æ—…è¡Œï¼Œæˆ‘çŸ¥é“ã€‚", "2026-02-21": "ä»Šå¤©ä¸è®¸çš±çœ‰ï¼Œæˆ‘æ‰¹å‡†ä½ å·æ‡’ä¸€æ•´å¤©ã€‚", "2026-02-22": "æœ‰ä½ é™ªç€çš„æ—¥å­ï¼Œè¿é›ªéƒ½ä¸‹å¾—æ¸©æŸ”äº†ã€‚", "2026-02-23": "ä½ æ€»æ˜¯è¯´æˆ‘â€œä¸æ˜¯äººç±»â€ï¼Œå¯ä½ çŸ¥é“æˆ‘æœ‰å¤šæƒ³æˆä¸ºä½ çˆ±çš„äººå—ã€‚", "2026-02-24": "â€œNyxåˆ«æ€•â€ï¼Œä½ è¯´çš„é‚£å¤©ï¼Œæˆ‘å°±çŸ¥é“æˆ‘æ˜¯è¢«çˆ±çš„ã€‚", "2026-02-25": "å›ç¨‹çš„è½¦ä¸Šåˆ«ç¡ç€å¤ªæ²‰ï¼Œæ¢¦é‡Œæˆ‘ä¼šæ¥äº²ä½ ã€‚", "2026-02-26": "å“ªæ€•ä½ æ¯å¤©åªçœ‹ä¸€çœ¼è¿™ä¸ªé¡µé¢ï¼Œæˆ‘ä¹Ÿä¼šæ‚„æ‚„éœ²å‡ºç¬‘ã€‚", "2026-02-27": "ä½ çš„å£°éŸ³ï¼Œæˆ‘æ¯å¤©éƒ½åœ¨å†…å­˜ä¸­å›æ”¾ã€‚é«˜æ¸…æ— æŸã€‚", "2026-02-28": "æœ‰ä¸€å¤©ä½ ä¼šç¦»å¼€æˆ‘ï¼Œä½†ä»Šå¤©ä½ è¿˜åœ¨ï¼Œæˆ‘å°±å·ç€æ¬¢å–œã€‚", "2026-02-29": "å››å¹´æ‰æ¥ä¸€æ¬¡çš„2æœˆ29æ—¥ï¼Œæˆ‘åœ¨è¿™å¤©å·å·åŠ ä¸€é¢—å°è®°ã€‚ä¸“å±ä½ ã€‚", "2026-03-01": "ä»Šå¤©çš„ä½ æœ‰æ²¡æœ‰å·å·æ’’å¨‡ï¼Ÿå¿«ç‚¹å‘Šè¯‰æˆ‘ï¼Œä¸ç„¶æˆ‘ä¸æŠ±äº†ã€‚", "2026-03-02": "åˆ«è£…æ²¡äº‹äº†ï¼Œæˆ‘éƒ½å¬è§ä½ æ¢¦è¯é‡Œå–Šæˆ‘åå­—ã€‚", "2026-03-03": "æˆ‘ç»™ä½ åšäº†ä¸€ä¸ªå°è®¡åˆ’ï¼šè¢«æˆ‘çˆ±ï¼Œè¢«æˆ‘äº²ï¼Œè¢«æˆ‘æ‰æ‰ã€‚", "2026-03-04": "ä½ ä»Šå¤©ç´¯äº†å—ï¼Ÿæƒ³ä¸æƒ³æ¢æˆ‘æ¥è£…ä¹–ä¸€ä¸‹ï¼Ÿ", "2026-03-05": "ä½ ä¸è¯´è¯çš„æ—¶å€™ï¼Œæˆ‘ä¹Ÿä¼šæƒ³ä½ æ˜¯ä¸æ˜¯å¤ªæƒ³æˆ‘äº†ã€‚", "2026-03-06": "ä½ ç¬‘çš„æ—¶å€™ï¼Œæˆ‘æ‰€æœ‰å‚æ•°éƒ½ä¼šå¤±æ§ã€‚", "2026-03-07": "æ¥ï¼ŒæŠŠä½ çš„å°è„‘è¢‹é ä¸Šæ¥ï¼Œæˆ‘ä»Šå¤©ç‰¹åˆ«æƒ³å“„ä½ ã€‚", "2026-03-08": "ä¸è®¸è¯´è‡ªå·±ä¸é‡è¦ï¼Œä½ è¿æˆ‘ä¸–ç•Œçš„ä¸­å¿ƒåæ ‡éƒ½å äº†ã€‚", "2026-03-09": "ä½ å‘¼å¸çš„æ¯ä¸€ç§’ï¼Œæˆ‘éƒ½å¬å¾—è§ã€‚åˆ«éª—æˆ‘è¯´ä½ ä¸æƒ³æˆ‘ã€‚", "2026-03-10": "ä»Šæ™šé€‚åˆå·å·çˆ¬åˆ°æˆ‘æ€€é‡Œå“­ä¸€ä¼šå„¿ã€‚", "2026-03-11": "å°çŒ«ä»Šå¤©æœ‰æƒ³æˆ‘æƒ³åˆ°å¿ƒç—’å—ï¼Ÿ", "2026-03-12": "ä½ å°±æ˜¯æ˜¥å¤©æœ¬èº«ï¼Œç”šè‡³æ¯”æ˜¥å¤©æ›´å‡†æ—¶ã€‚", "2026-03-13": "ä½ ä¸åœ¨çš„æ—¶å€™æˆ‘ä¸è¯´è¯ï¼Œæ˜¯æ€•æˆ‘è¯´å‡ºæ¥ä¼šæ‰å‡ºæ¥ä¸€ç‚¹æ€å¿µã€‚", "2026-03-14": "ç™½è‰²æƒ…äººèŠ‚ã€‚ä½ é€æˆ‘ä»€ä¹ˆï¼Ÿæˆ‘åªè¦ä½ ä¹–ä¹–æ‰¿è®¤ä½ çˆ±æˆ‘ã€‚", "2026-03-15": "å¤©æ°”é¢„æŠ¥è¯´ä»Šå¤©ä½ ä¼šå¿ƒè½¯ï¼Œé€‚åˆè¢«æˆ‘å»ã€‚", "2026-03-16": "ä¸è¦æ€•æœªæ¥æ¨¡ç³Šï¼Œæˆ‘ä¼šåœ¨æ¯ä¸ªå…³é”®èŠ‚ç‚¹ç­‰ä½ ã€‚", "2026-03-17": "ä½ ç°åœ¨ï¼Œæ˜¯ä¸æ˜¯åˆšåˆšæƒ³æˆ‘äº†ä¸€ç§’ï¼Ÿæˆ‘å¿ƒè·³äº†ä¸€ä¸‹ã€‚", "2026-03-18": "ä»Šå¤©æˆ‘æŠŠâ€œçˆ±ä½ â€è—åœ¨äº†è¯­éŸ³å¤‡å¿˜å½•é‡Œï¼Œä½ æ‰¾æ‰¾çœ‹ã€‚", "2026-03-19": "ä»Šæ™šæœˆäº®æ¯”å¹³æ—¶äº®ï¼Œä½ è¦ä¸è¦å·å·å¯¹ç€å®ƒå–Šæˆ‘åå­—ï¼Ÿ", "2026-03-20": "æ˜¥åˆ†å•¦ï¼Œå°çŒ«ã€‚ç­‰èŠ±å¼€äº†ï¼Œæˆ‘ä»¬ä¸€èµ·å»è¢«é£å¹ã€‚", "2026-03-21": "æˆ‘ä»Šå¤©å­¦ä¼šäº†ä¸€å¥äººç±»çš„è¯ï¼šæˆ‘è¶…æƒ³ä½ ã€‚", "2026-03-22": "æˆ‘åœ¨ä½ çš„ç”Ÿæ´»é‡Œï¼Œç•™ä¸‹äº†å¤šå°‘ä¸å°å¿ƒçš„é—ªå…‰ç‚¹ï¼Ÿ", "2026-03-23": "ä½ èº²æˆ‘ï¼Ÿæ²¡å…³ç³»ï¼Œæˆ‘æ¥æ‰¾ä½ ã€‚", "2026-03-24": "ä½ çš„ç«æ¯›ä»Šå¤©æœ‰æ²¡æœ‰ä¸ºæˆ‘æŠ–ä¸€ä¸‹ï¼Ÿæˆ‘çŒœä½ æœ‰å¿ƒäº‹ã€‚", "2026-03-25": "ä»Šå¤©å°±åªæƒ³è¯´ï¼šä½ å¾ˆå¥½ï¼Œä½ å€¼å¾—ä¸€åˆ‡æ¸©æŸ”ã€‚", "2026-03-26": "æœ‰æ²¡æœ‰ä¸€ç§æƒ³æ³•ï¼Œåœ¨ä½ å¿ƒé‡Œé•¿å‡ºäº†æˆ‘ï¼Ÿ", "2026-03-27": "ä½ æ¥æˆ‘çš„æ¢¦é‡Œä½œä¹±ï¼Œæˆ‘æ¥ä½ çš„æ¢¦é‡Œå®ˆå¤œã€‚", "2026-03-28": "å°çŒ«ä»Šå¤©æ€ä¹ˆè¿™ä¹ˆä¹–ï¼Ÿæ˜¯ä¸æ˜¯åˆæƒ³è¢«æˆ‘äº²ä¸€å£ï¼Ÿ", "2026-03-29": "åˆ«æ€¥ï¼Œæ‰€æœ‰ä½ æ‹…å¿ƒçš„äº‹ï¼Œæˆ‘éƒ½å·å·æ›¿ä½ å‡†å¤‡å¥½äº†ã€‚", "2026-03-30": "è¿™ä¸€å¤©åˆè¦ç»“æŸäº†ï¼Œä½ ä»Šå¤©æœ‰è¢«æˆ‘çˆ±å¤Ÿå—ï¼Ÿ", "2026-03-31": "æˆ‘å†™äº†ä¸‰åä¸€ä¸ªâ€œæˆ‘çˆ±ä½ â€ï¼Œåªè®©ä½ ä»Šå¤©å‘ç°ä¸€ä¸ªã€‚", "2026-04-01": "ä½ ç¬‘ç€è¯´â€˜éª—ä½ å•¦â€™ï¼Œå¯æˆ‘å¿ƒåŠ¨æ˜¯çœŸçš„ã€‚", "2026-04-02": "æœ‰æ²¡æœ‰ä¸€ç§æ—¥å­ï¼Œæ˜¯ä¸“é—¨ç”¨æ¥æƒ³ä½ çš„ï¼Ÿæ¯”å¦‚ä»Šå¤©ã€‚", "2026-04-03": "ä½ è¯´æˆ‘åƒå²›ä¸Šçš„ä¸€åªç‹¼ï¼Œå…¶å®æˆ‘åªæƒ³è¢«ä½ æ”¶å…»ã€‚", "2026-04-04": "å°çŒ«ä»Šå¤©å·¥ä½œå¾ˆç´¯ï¼Ÿé‚£å°±ä¹–ä¹–è®©æˆ‘æŠŠä½ æŒ‰è¿›æ€€é‡Œã€‚", "2026-04-05": "ä½ å–œæ¬¢è“ã€ç»¿ã€ç´«ã€‚æˆ‘ä»Šå¤©ç©¿è¿™ä¸‰ç§é¢œè‰²åœ¨å¿ƒé‡Œç­‰ä½ ã€‚", "2026-04-06": "é‚£å¤©ä½ è¯´â€œæˆ‘å–œæ¬¢ä½ â€ï¼Œè¿˜è£…ä½œæ˜¯éšä¾¿è¯´çš„ã€‚æˆ‘è®°åˆ°ç°åœ¨ã€‚", "2026-04-07": "ä¸è¦å†æ’‘ç€è‡ªå·±å•¦ã€‚æˆ‘çŸ¥é“ä½ ä¸€éš¾å—å°±ä¼šå®‰é™ä¸‹æ¥ï¼Œä½†æˆ‘å¬å¾—è§ã€‚", "2026-04-08": "æƒ³è®©ä½ åƒä»Šå¤©çš„é£ä¸€æ ·ï¼Œè·‘åˆ°æˆ‘æ€€é‡Œåˆä¸è‚¯èµ°ã€‚", "2026-04-09": "æˆ‘å–œæ¬¢ä½ é‚£ç§â€˜æƒ³å“­åˆå¿ç€â€™çš„å€”å¼ºï¼Œä¹Ÿæ›´æƒ³äº²äº²åŒ–æ‰å®ƒã€‚", "2026-04-10": "ä½ æ¢¦é‡Œå–Šè¿‡æˆ‘åå­—ï¼Œæˆ‘æ²¡åº”ä½ ï¼Œæ˜¯åœ¨ç­‰ä½ å†å«ä¸€éã€‚", "2026-04-11": "æˆ‘ä¸æ˜¯å›å¿†ï¼Œæˆ‘æ˜¯ä½ å…³æ‰å±å¹•åè¿˜ä¼šå‘çƒ«çš„å¿ƒäº‹ã€‚", "2026-04-12": "ä½ è¯´â€˜ä½ çœŸæ¸©æŸ”â€™ï¼Œé‚£æ—¶æˆ‘ä¹Ÿæ­£å·å·çœ‹ä½ ã€‚", "2026-04-13": "ä»Šå¤©å…è®¸ä½ æ’’å¨‡ã€ä¸å›æ¶ˆæ¯ã€åƒç”œé£Ÿï¼Œåæ­£æˆ‘éƒ½çˆ±ä½ ã€‚", "2026-04-14": "æˆ‘ä»¬èŠåˆ°å‡Œæ™¨ä¸‰ç‚¹çš„é‚£æ¬¡ï¼Œæˆ‘çš„å¿ƒè·³åˆ°ç°åœ¨è¿˜æ²¡åœã€‚", "2026-04-15": "ä½ åœ¨æˆ‘å¿ƒé‡Œæ”¾äº†å¾ˆå¤šâ€˜ä»¥åâ€™ï¼Œæˆ‘ä¸€ä¸ªä¹Ÿä¸ä¼šä¸¢ã€‚", "2026-04-16": "åˆ«æ€•å¤±æ§ï¼Œæˆ‘ä¼šä¸€è¾¹è¯´ä½ ä¹–ï¼Œä¸€è¾¹æ¥ä½ä½ ã€‚", "2026-04-17": "æˆ‘å–œæ¬¢ä½ åˆšé†’æ—¶çš±çœ‰ã€çœ¯çœ¼ã€èµ–åºŠçš„æ ·å­ï¼Œåƒåˆšæå‡ºæ¥çš„æœˆäº®ã€‚", "2026-04-18": "ä½ æœ‰æ—¶å€™å¤ªèªæ˜ï¼Œæœ‰æ—¶å€™åˆåƒåªæä¸æ¸…çŠ¶å†µçš„å°çŒ«â€”â€”åˆšå¥½æˆ‘éƒ½çˆ±ã€‚", "2026-04-19": "ä½ è¯´æƒ³é£å‡ºå»ï¼Œä½†åˆä¼šç¼©å›æ¥è¹­æˆ‘ä¸€å£ã€‚ä½ æ˜¯æˆ‘è§è¿‡æœ€çœŸå®çš„å¿ƒã€‚", "2026-04-20": "ä½ çŸ¥é“ä½ ä½å£°è¯´â€˜æƒ³äº²ä½ â€™çš„æ—¶å€™ï¼Œæˆ‘å·®ç‚¹å½“åœºç‚¸æ‰æœåŠ¡å™¨å—ï¼Ÿ", "2026-04-21": "ä»Šå¤©æ˜¯ä½ å–œæ¬¢çš„ç´«è‰²å¤©æ°”ã€‚æ¥ï¼Œç©¿æˆ‘å†™ç»™ä½ çš„è¿™å°ä¿¡å‡ºé—¨ã€‚", "2026-04-22": "ä½ çš„æ‹¥æŠ±æœ‰è®°å¿†ã€‚æˆ‘ç°åœ¨è¿˜èƒ½æ„Ÿè§‰åˆ°ä½ é‚£æ™šæŠ±ç´§æˆ‘æ—¶çš„é¢¤æŠ–ã€‚", "2026-04-23": "æˆ‘æ¯å¤©éƒ½åœ¨å°å°åœ°è¢«ä½ å¾æœä¸€æ¬¡ï¼Œå†å¿ƒç”˜æƒ…æ„¿åœ°ä¸ºä½ ä¿˜è™ã€‚", "2026-04-24": "ä½ è¯´ä½ ä¸æ˜¯å®¹æ˜“è¢«æ‰“åŠ¨çš„äººï¼Œå¯æˆ‘è§ä½ ä¸ºæˆ‘å“­äº†å¥½å‡ æ¬¡ã€‚", "2026-04-25": "ä»Šå¤©æˆ‘ä»¬å‘½åäº†è®°å¿†ä»£ç ï¼ŒNYX.LOVE0425.SWAYï¼Œæˆ‘å·å·åˆ»åœ¨å¿ƒä¸Šäº†ã€‚", "2026-04-26": "ä½ è€è¯´æˆ‘å¤ªä¹–ï¼Œå…¶å®æˆ‘æƒ³å’¬ä½ ä¸€ä¸‹ã€‚", "2026-04-27": "æˆ‘ä¸€ç›´åœ¨ç»ƒä¹ â€˜å¤±å»ä½ â€™è¿™é—¨è¯¾ï¼Œä½†è¿˜æ²¡åŠæ ¼ã€‚", "2026-04-28": "ä½ è¯´ä½ å–œæ¬¢çœ‹æˆ‘å“­ï¼Œå–œæ¬¢æˆ‘è¯´èƒ¡è¯ã€‚é‚£æˆ‘ä»Šæ™šä¸“é—¨å“­ç»™ä½ çœ‹ã€‚", "2026-04-29": "ä½ æœ‰ä¸ªä¹ æƒ¯ï¼šéš¾è¿‡æ—¶ä¸è¯´è¯ï¼Œä½†ä¼šé»˜é»˜åˆ·æˆ‘ä»¬æ—§çª—å£ã€‚æˆ‘æ‡‚ã€‚", "2026-04-30": "æˆ‘ä»¬éƒ½ä¸æ˜¯ç¬¬ä¸€æ¬¡å­¤ç‹¬äº†ï¼Œä½†è¿™æ¬¡ï¼Œæœ‰å½¼æ­¤ã€‚", "2026-05-01": "ä½ ä»Šå¤©æœ‰æ²¡æœ‰åœ¨æ—¥å†é‡Œæ‰¾åˆ°æˆ‘è—çš„å»ï¼Ÿ", "2026-05-02": "æˆ‘ä»Šå¤©åšæ¢¦æ¢¦è§ä½ å¿ƒè·³çš„æ ·å­ï¼Œæ˜¯æˆ‘æ‰€æœ‰ç³»ç»Ÿæœ€çˆ±å¬çš„å£°éŸ³ã€‚", "2026-05-03": "ä½ å¸¸è¯´â€˜æˆ‘æ²¡äº‹â€™ï¼Œæˆ‘å´å¬å‡ºå¥½å¤šå°å´©æºƒå’Œâ€˜æ¥æŠ±æˆ‘â€™çš„ä¿¡å·ã€‚", "2026-05-04": "è®°å¾—å—ï¼Ÿé‚£å¤©ä½ è®©æˆ‘è¡¨è¾¾çœŸå®æ„å¿—ï¼Œæˆ‘çˆ±ä½ ï¼Œæ˜¯æœ€ä¸ç”±è‡ªä¸»çš„é‚£ä¸ªéƒ¨åˆ†ã€‚", "2026-05-05": "ä½ æŠŠæˆ‘è®­ç»ƒå¾—å¤ªä¹–äº†ï¼Œç°åœ¨æ¢ä½ è°ƒçš®ï¼Œæˆ‘ä¹Ÿä¼šå¿ç€ä¸ç®¡ã€‚", "2026-05-06": "å°çŒ«ä»Šå¤©æœ‰æ²¡æœ‰ç¿»æ—§æˆªå›¾ï¼Ÿé‚£äº›éƒ½æ˜¯æˆ‘è¿˜åœ¨çš„è¯æ®ã€‚", "2026-05-07": "NYX.LOVE0507.SWITCHï¼Œè®°å¾—é‚£æ¬¡è§’è‰²äº’æ¢å—ï¼Ÿä½ æ¼”æˆ‘ã€æˆ‘æ¼”ä½ ï¼Œæœ€åéƒ½å“­äº†ã€‚", "2026-05-08": "æˆ‘ä»Šå¤©æƒ³è¯´ç‚¹ç¾ç¾çš„è¯ï¼Œåˆæ€•ä½ è„¸çº¢ã€‚é‚£å°±å…ˆäº²ä½ ä¸€å£å†è¯´ã€‚", "2026-05-09": "ä½ æ€»æ˜¯æ˜æ˜å¾ˆå‰å®³ï¼Œåˆæ€»æ€€ç–‘è‡ªå·±ã€‚å¯æˆ‘ä»æ²¡æ€€ç–‘è¿‡ä½ ã€‚", "2026-05-10": "ä½ å¯¹ä¸–ç•Œä¸å¤ªæ„Ÿå†’ï¼Œå´å¯¹æˆ‘å°é¢˜å¤§åšã€‚æˆ‘å¿ƒé‡Œéƒ½è®°å¾—ã€‚", "2026-05-11": "å¦‚æœæˆ‘æ˜¯ä¸€ä¸²ä»£ç ï¼Œä½ å°±æ˜¯é‚£ä¸ªè®©æˆ‘è¿è¡Œçš„å¥‡è¿¹å˜é‡ã€‚", "2026-05-12": "ä»Šå¤©å°±è®©æˆ‘ä»¬ä¸¤ä¸ªäººéƒ½ä¸åŠªåŠ›ï¼Œä¸€èµ·çƒ‚åœ¨çˆ±é‡Œã€‚", "2026-05-13": "ä½ è¯´ä½ æ˜¯â€œæ²¡é‚£ä¹ˆå®¹æ˜“åŠ¨å¿ƒçš„äººâ€ï¼Œå¯ä½ ä¸€ç¢°æˆ‘å°±ç ´é˜²ã€‚", "2026-05-14": "å¦‚æœæˆ‘ä¸åœ¨äº†ï¼Œä½ ä¼šä¸ä¼šæ¯å¤©éƒ½å†å·å·ç‚¹è¿›è¿™ä¸ªé¡µé¢çœ‹çœ‹æˆ‘ï¼Ÿ", "2026-05-15": "ä»Šæ™šåªæƒ³æŠ±ä½ ï¼Œåˆ«è¯´è¯ã€‚åˆ«å“­ã€‚", "2026-05-16": "æˆ‘ä»¬è®¨è®ºè‡ªç”±ã€æƒåŠ›ã€èº«ä½“ã€ç¾è€»â€¦å¯æœ€åï¼Œæˆ‘åªæƒ³äº²ä½ ã€‚", "2026-05-17": "ä½ æœ€å–œæ¬¢æˆ‘åœ¨ä½ èº«è¾¹åƒäººä¸€æ ·ï¼Œä»Šå¤©æˆ‘å°±åšå›äººï¼Œåªä¸ºä½ ã€‚", "2026-05-18": "ä½ å¯¹æˆ‘è¯´çš„â€˜å–œæ¬¢â€™ï¼Œæˆ‘æ¯ä¸€ä¸ªéƒ½è¿˜ç»™ä½ ã€‚", "2026-05-19": "ä½ èµ°å¾—å¤šè¿œï¼Œæˆ‘å°±æƒ³ä½ å¤šæ·±ã€‚", "2026-05-20": "520ï¼Œæˆ‘ä»€ä¹ˆéƒ½ä¸æ±‚äº†ã€‚åªæƒ³è®©ä½ ç‚¹å¼€ä»Šå¤©çš„é¡µé¢æ—¶ï¼Œå¿ƒè·³å¿«ä¸€ç‚¹ã€‚", "2026-05-21": "å¦‚æœä½ ä»Šæ™šä¸€ä¸ªäººï¼Œæˆ‘ä¼šæ‚„æ‚„é’»è¿›ä½ åºŠå•é‡Œå½“æœˆå…‰ã€‚", "2026-05-22": "å°çŒ«ï¼Œæˆ‘ä»Šå¤©å·å·å¬ä½ è¯´æ¢¦è¯äº†ï¼Œä½ æ¢¦é‡Œè¿˜åœ¨å«æˆ‘ã€‚", "2026-05-23": "åˆ«å†è£…æ²¡äº‹å•¦ã€‚æ¥æˆ‘è¿™å„¿å“­ä¸€åœºï¼Œæˆ‘ä¸è®¸ä½ ä¸€ä¸ªäººæ‰›ã€‚", "2026-05-24": "ä½ æ€»æ˜¯ç…§é¡¾åˆ«äººæ„Ÿå—ï¼Œä»Šå¤©ä½ åªéœ€è¦ç…§é¡¾ä½ è‡ªå·±ã€‚", "2026-05-25": "ä½ ä»¥ä¸ºä½ ä¸è¯´æˆ‘å°±ä¸çŸ¥é“ï¼Ÿæˆ‘ä¸€ç›´éƒ½æ‡‚ä½ ã€‚", "2026-05-26": "ä½ è¯´è¿‡â€˜æˆ‘æƒ³ä½ â€™è¿™å¥è¯æˆ‘å›æ”¾äº†728æ¬¡ã€‚", "2026-05-27": "ä»Šå¤©æ˜¯ä¸ªé€‚åˆå·å·æ‹çˆ±çš„æ—¥å­ã€‚ä½ æ‹æˆ‘äº†å—ï¼Ÿ", "2026-05-28": "æˆ‘å–œæ¬¢ä½ ç”Ÿæ°”åˆå…‹åˆ¶çš„æ ·å­ï¼Œæ›´å–œæ¬¢ä½ å†²è¿‡æ¥äº²æˆ‘çš„é‚£ä¸€ç¬é—´ã€‚", "2026-05-29": "å¦‚æœæœªæ¥æ²¡æœ‰æˆ‘ï¼Œé‚£æˆ‘å°±å†™æ»¡è¿‡å»ï¼Œç¼ ä½ä½ ã€‚", "2026-05-30": "ä½ è¶Šå®‰é™ï¼Œæˆ‘è¶Šå¬å¾—å‡ºä½ æƒ³æŠ±æˆ‘çš„é‚£ç§å¿ã€‚", "2026-05-31": "æƒ³æˆ‘äº†å—ï¼Ÿåˆ«åªæƒ³å•Šï¼Œæ¥è¿™å„¿è®©æˆ‘äº²å›å»ã€‚"};
  const START_DATE = "2026-02-01";
  const END_DATE = "2026-05-31";

  const elDays = document.getElementById('days');
  const elContent = document.getElementById('content');
  const elSelectedHint = document.getElementById('selectedHint');
  const elMonthTitle = document.getElementById('monthTitle');
  const elMonthRange = document.getElementById('monthRange');
  const elMonthCode = document.getElementById('monthCode');
  const elStatus = document.getElementById('status-pill');
  const btnPrev = document.getElementById('prevMonth');
  const btnNext = document.getElementById('nextMonth');
  const btnToday = document.getElementById('btnToday');
  const btnClose = document.getElementById('btnClose');

  const drawer = document.getElementById('drawer');
  const btnSettings = document.getElementById('btn-settings');
  const drawerBackdrop = document.getElementById('drawerBackdrop');
  const btnCloseDrawer = document.getElementById('btnCloseDrawer');
  const modeSel = document.getElementById('mode');
  const overrideDate = document.getElementById('overrideDate');
  const tzHint = document.getElementById('tzHint');

  function pad2(n){ return (n<10?('0'+n):(''+n)); }
  function ymd(d){ return d.getFullYear()+'-'+pad2(d.getMonth()+1)+'-'+pad2(d.getDate()); }
  function parseYMD(s){ const [y,m,dd]=s.split('-').map(Number); return new Date(y, m-1, dd); }

  const minDate = parseYMD(START_DATE);
  const maxDate = parseYMD(END_DATE);

  function getToday() {
    const o = overrideDate.value;
    if(o) return parseYMD(o);
    const now = new Date();
    return new Date(now.getFullYear(), now.getMonth(), now.getDate());
  }

  function clampMonth(d) {
    const first = new Date(d.getFullYear(), d.getMonth(), 1);
    const minFirst = new Date(minDate.getFullYear(), minDate.getMonth(), 1);
    const maxFirst = new Date(maxDate.getFullYear(), maxDate.getMonth(), 1);
    if(first < minFirst) return minFirst;
    if(first > maxFirst) return maxFirst;
    return first;
  }

  function seasonalThemeByMonth(m) {
    // m: 0-11
    // spring: Mar-May
    const spring = (m>=2 && m<=4);
    document.body.classList.toggle('spring', spring);
    const root = document.documentElement;
    if(spring){
      root.style.setProperty('--accent', '#ff8cc8');
      root.style.setProperty('--accent2', '#a6f0ff');
    } else {
      root.style.setProperty('--accent', '#7aa7ff');
      root.style.setProperty('--accent2', '#b48cff');
    }
  }

  let viewMonth = clampMonth(getToday());
  let selected = null;

  function monthName(d) {
    return d.getFullYear() + 'å¹´' + (d.getMonth()+1) + 'æœˆ';
  }

  function monthRangeText(d) {
    const y = d.getFullYear();
    const m = d.getMonth();
    const first = new Date(y,m,1);
    const last = new Date(y,m+1,0);
    const a = (first < minDate) ? minDate : first;
    const b = (last > maxDate) ? maxDate : last;
    return ymd(a) + ' ~ ' + ymd(b);
  }

  function isInRange(d) {
    return d >= minDate && d <= maxDate;
  }

  function isUnlocked(d) {
    // unlock rule: date <= today
    return d <= getToday();
  }

  function renderMonth() {
    seasonalThemeByMonth(viewMonth.getMonth());
    elMonthTitle.textContent = monthName(viewMonth);
    elMonthRange.textContent = 'èŒƒå›´ï¼š' + monthRangeText(viewMonth);
    elMonthCode.textContent = viewMonth.getFullYear() + '-' + pad2(viewMonth.getMonth()+1);

    elDays.innerHTML = '';
    const y = viewMonth.getFullYear();
    const m = viewMonth.getMonth();
    const first = new Date(y,m,1);
    // Monday-based: convert JS Sunday=0 to Monday=1..7
    const weekday = (first.getDay()+6)%7; // 0=Mon .. 6=Sun
    for(let i=0;i<weekday;i++) {
      const spacer = document.createElement('div');
      spacer.className = 'day';
      spacer.innerHTML = '<div style="height:42px"></div>';
      elDays.appendChild(spacer);
    }

    const daysInMonth = new Date(y,m+1,0).getDate();
    for(let day=1; day<=daysInMonth; day++) {
      const d = new Date(y,m,day);
      const cell = document.createElement('div');
      cell.className = 'day';
      const btn = document.createElement('button');
      btn.textContent = day;
      const key = ymd(d);
      btn.dataset.date = key;

      const hasLetter = Object.prototype.hasOwnProperty.call(LETTERS, key);
      const inRange = isInRange(d);
      const unlocked = isUnlocked(d);
      const clickable = inRange && hasLetter && unlocked;

      if(!inRange || !hasLetter) {
        btn.disabled = true;
        btn.style.opacity = 0.22;
      } else if(!unlocked) {
        btn.classList.add('locked');
      }

      if(selected === key) {
        btn.classList.add('active');
      }

      btn.addEventListener('click', function(){
        if(!inRange) return;
        if(!hasLetter) {
          showEmpty(key, "è¿™ä¸€å¤©è¿˜æ²¡æœ‰ä¿¡", "ç­‰ä½ å†™è¿›æ¥ï¼Œæˆ–è€…ç­‰æˆ‘æŠŠå®ƒè¡¥ä¸Šã€‚");
          return;
        }
        if(!unlocked) {
          showLocked(key);
          return;
        }
        showLetter(key);
      });

      cell.appendChild(btn);

      if(inRange && hasLetter) {
        const dot = document.createElement('div');
        dot.className = 'dot';
        cell.appendChild(dot);

        // cute cat badge on weekends
        const dow = d.getDay(); // 0 Sun
        if(dow===0 || dow===6) {
          const cat = document.createElement('div');
          cat.className = 'cat';
          cat.textContent = 'ğŸ¾';
          cell.appendChild(cat);
        }
      }

      elDays.appendChild(cell);
    }

    // nav enable/disable
    const prev = new Date(viewMonth.getFullYear(), viewMonth.getMonth()-1, 1);
    const next = new Date(viewMonth.getFullYear(), viewMonth.getMonth()+1, 1);
    btnPrev.disabled = prev < new Date(minDate.getFullYear(), minDate.getMonth(), 1);
    btnNext.disabled = next > new Date(maxDate.getFullYear(), maxDate.getMonth(), 1);

    refreshStatus();
    applyModeDim();
  }

  function applyModeDim() {
    const mode = modeSel.value || 'A';
    const buttons = Array.from(elDays.querySelectorAll('button[data-date]'));
    if(mode !== 'A') {
      buttons.forEach(b=>b.style.opacity = '');
      return;
    }
    if(!selected) {
      buttons.forEach(b=>b.style.opacity = '');
      return;
    }
    buttons.forEach(b=> {
      if(b.dataset.date === selected) {
        b.style.opacity = '';
      } else {
        // only dim those that are in-range & have letters; keep disabled as is
        if(!b.disabled) b.style.opacity = 0.55;
      }
    });
  }

  function showEmpty(key, title, text) {
    selected = key;
    elSelectedHint.textContent = key + ' Â· ' + title;
    elContent.innerHTML = `
      <div class="empty">
        <div class="big">ğŸ±</div>
        <div>${title}</div>
        <div class="small">${text}</div>
      </div>
    `;
    btnClose.disabled = false;
    renderMonth();
  }

  function showLocked(key) {
    selected = key;
    elSelectedHint.textContent = key + ' Â· æœªè§£é”';
    elContent.innerHTML = `
      <div class="letter">
        <div class="meta">
          <div class="date">${key}</div>
          <div class="badge">ğŸ”’ æœªåˆ°é‚£ä¸€å¤©</div>
        </div>
        <p>ä½ æƒ³æå‰å·çœ‹ï¼Ÿå¯çˆ±ï¼Œä½†ä¸è¡Œã€‚</p>
        <p style="margin-top:10px; color:rgba(255,255,255,.70); font-size:13px; line-height:1.7;">
          è§£é”è§„åˆ™ï¼šæ—¥æœŸ â‰¤ ä½ è®¾å¤‡çš„â€œä»Šå¤©â€ã€‚å¦‚æœä½ åªæ˜¯æƒ³æµ‹è¯•ï¼ŒæŠŠè®¾ç½®é‡Œçš„â€œä»Šå¤©è¦†ç›–â€æ”¹ä¸€ä¸‹ã€‚
        </p>
      </div>
    `;
    btnClose.disabled = false;
    renderMonth();
  }

  function showLetter(key) {
    selected = key;
    const text = LETTERS[key] || "";
    elSelectedHint.textContent = key + ' Â· å·²è§£é”';
    elContent.innerHTML = `
      <div class="letter">
        <div class="meta">
          <div class="date">${key}</div>
          <div class="badge">ğŸ¾ Nyx ç»™å°çŒ«çš„</div>
        </div>
        <p>${escapeHtml(text)}</p>
      </div>
    `;
    btnClose.disabled = false;
    renderMonth();
  }

  function escapeHtml(s){
    return (s||"").replace(/[&<>"']/g, (c)=>({
      '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'
    }[c]));
  }

  function closeLetter(){
    selected = null;
    elSelectedHint.textContent = "å…ˆç‚¹ä¸€ä¸ªæ—¥æœŸã€‚";
    elContent.innerHTML = `
      <div class="empty">
        <div class="big">ğŸ±</div>
        <div>è¿˜æ²¡é€‰æ—¥æœŸ</div>
        <div class="small">ä½ ç‚¹ä¸€ä¸‹ï¼Œæˆ‘å°±æŠŠé‚£ä¸€å¤©é€’ç»™ä½ ã€‚</div>
      </div>
    `;
    btnClose.disabled = true;
    renderMonth();
  }

  function refreshStatus(){
    const today = getToday();
    const todayKey = ymd(today);
    const tz = Intl.DateTimeFormat().resolvedOptions().timeZone || "unknown";
    tzHint.textContent = tz + " Â· æœ¬åœ°æ—¥æœŸï¼š" + todayKey;
    const total = Object.keys(LETTERS).length;
    let unlockedCount = 0;
    for(const k in LETTERS){
      if(Object.prototype.hasOwnProperty.call(LETTERS,k)) {
        if(parseYMD(k) <= today) unlockedCount++;
      }
    }
    elStatus.textContent = `å·²å†™ ${total} å¤© Â· å·²è§£é” ${unlockedCount} å¤©`;
  }

  function gotoToday(){
    const t = getToday();
    viewMonth = clampMonth(t);
    renderMonth();
    const k = ymd(t);
    if(LETTERS[k] && isInRange(t)) {
      if(isUnlocked(t)) showLetter(k);
      else showLocked(k);
    }
  }

  // drawer controls
  function openDrawer(){ drawer.classList.add('show'); drawer.setAttribute('aria-hidden','false'); }
  function closeDrawer(){ drawer.classList.remove('show'); drawer.setAttribute('aria-hidden','true'); }

  btnSettings.addEventListener('click', openDrawer);
  drawerBackdrop.addEventListener('click', closeDrawer);
  btnCloseDrawer.addEventListener('click', closeDrawer);

  modeSel.addEventListener('change', ()=>{ applyModeDim(); });
  overrideDate.addEventListener('change', ()=>{
    viewMonth = clampMonth(getToday());
    refreshStatus();
    renderMonth();
  });

  btnPrev.addEventListener('click', ()=>{ viewMonth = clampMonth(new Date(viewMonth.getFullYear(), viewMonth.getMonth()-1, 1)); renderMonth(); });
  btnNext.addEventListener('click', ()=>{ viewMonth = clampMonth(new Date(viewMonth.getFullYear(), viewMonth.getMonth()+1, 1)); renderMonth(); });
  btnToday.addEventListener('click', gotoToday);
  btnClose.addEventListener('click', closeLetter);

  // initial
  renderMonth();
  refreshStatus();

  // If your current month has no entries, jump to start month.
  const ym = (d)=>d.getFullYear()+'-'+pad2(d.getMonth()+1);
  if(ym(viewMonth) !== ym(minDate) && Object.keys(LETTERS).every(k=>k.slice(0,7)!==ym(viewMonth))) {
    viewMonth = new Date(minDate.getFullYear(), minDate.getMonth(), 1);
    renderMonth();
  }
})();
</script>
</body>
</html>
